# é¢˜ç›®åœ°å€ï¼ˆ1261. åœ¨å—æ±¡æŸ“çš„äºŒå‰æ ‘ä¸­æŸ¥æ‰¾å…ƒç´ ï¼‰

https://leetcode-cn.com/problems/find-elements-in-a-contaminated-binary-tree/

## é¢˜ç›®æè¿°

```
ç»™å‡ºä¸€ä¸ªæ»¡è¶³ä¸‹è¿°è§„åˆ™çš„äºŒå‰æ ‘ï¼š

root.val == 0
å¦‚æœ treeNode.val == x ä¸”Â treeNode.left != nullï¼Œé‚£ä¹ˆÂ treeNode.left.val == 2 * x + 1
å¦‚æœ treeNode.val == x ä¸” treeNode.right != nullï¼Œé‚£ä¹ˆÂ treeNode.right.val == 2 * x + 2
ç°åœ¨è¿™ä¸ªäºŒå‰æ ‘å—åˆ°ã€Œæ±¡æŸ“ã€ï¼Œæ‰€æœ‰çš„Â treeNode.valÂ éƒ½å˜æˆäº†Â -1ã€‚

è¯·ä½ å…ˆè¿˜åŸäºŒå‰æ ‘ï¼Œç„¶åå®ç°Â FindElementsÂ ç±»ï¼š

FindElements(TreeNode* root)Â ç”¨å—æ±¡æŸ“çš„äºŒå‰æ ‘åˆå§‹åŒ–å¯¹è±¡ï¼Œä½ éœ€è¦å…ˆæŠŠå®ƒè¿˜åŸã€‚
bool find(int target)Â åˆ¤æ–­ç›®æ ‡å€¼Â targetÂ æ˜¯å¦å­˜åœ¨äºè¿˜åŸåçš„äºŒå‰æ ‘ä¸­å¹¶è¿”å›ç»“æœã€‚
Â 

ç¤ºä¾‹ 1ï¼š
```

![](https://p.ipic.vip/t0vzeb.jpg)

```
è¾“å…¥ï¼š
["FindElements","find","find"]
[[[-1,null,-1]],[1],[2]]
è¾“å‡ºï¼š
[null,false,true]
è§£é‡Šï¼š
FindElements findElements = new FindElements([-1,null,-1]);
findElements.find(1); // return False
findElements.find(2); // return True
ç¤ºä¾‹ 2ï¼š
```

![](https://p.ipic.vip/ga36n0.jpg)

```
è¾“å…¥ï¼š
["FindElements","find","find","find"]
[[[-1,-1,-1,-1,-1]],[1],[3],[5]]
è¾“å‡ºï¼š
[null,true,true,false]
è§£é‡Šï¼š
FindElements findElements = new FindElements([-1,-1,-1,-1,-1]);
findElements.find(1); // return True
findElements.find(3); // return True
findElements.find(5); // return False
ç¤ºä¾‹ 3ï¼š
```

![](https://p.ipic.vip/4ruo3z.jpg)

```
è¾“å…¥ï¼š
["FindElements","find","find","find","find"]
[[[-1,null,-1,-1,null,-1]],[2],[3],[4],[5]]
è¾“å‡ºï¼š
[null,true,false,false,true]
è§£é‡Šï¼š
FindElements findElements = new FindElements([-1,null,-1,-1,null,-1]);
findElements.find(2); // return True
findElements.find(3); // return False
findElements.find(4); // return False
findElements.find(5); // return True
Â 

æç¤ºï¼š

TreeNode.val == -1
äºŒå‰æ ‘çš„é«˜åº¦ä¸è¶…è¿‡Â 20
èŠ‚ç‚¹çš„æ€»æ•°åœ¨Â [1,Â 10^4]Â ä¹‹é—´
è°ƒç”¨Â find()Â çš„æ€»æ¬¡æ•°åœ¨Â [1,Â 10^4]Â ä¹‹é—´
0 <= target <= 10^6

```

## å‰ç½®çŸ¥è¯†

- äºŒè¿›åˆ¶

## æš´åŠ›æ³•

## å…¬å¸

- æš‚æ— 

### æ€è·¯

æœ€ç®€å•æƒ³æ³•å°±æ˜¯é€’å½’å»ºç«‹æ ‘ï¼Œç„¶å find çš„æ—¶å€™é€’å½’æŸ¥æ‰¾å³å¯ï¼Œä»£ç ä¹Ÿå¾ˆç®€å•ã€‚

### ä»£ç 

Pythpn Code:

```python
# Definition for a binary tree node.
# class TreeNode:
#     def __init__(self, x):
#         self.val = x
#         self.left = None
#         self.right = None

class FindElements:
    node = None
    def __init__(self, root: TreeNode):
        def recover(node):
            if not node:
                return node;
            if node.left:
                node.left.val =  2 * node.val + 1
            if node.right:
                 node.right.val = 2 * node.val + 2
            recover(node.left)
            recover(node.right)
            return node
        root.val = 0
        self.node = recover(root)


    def find(self, target: int) -> bool:
        def findInTree(node, target):
            if not node:
                return False
            if node.val == target:
                return True
            return findInTree(node.left, target) or findInTree(node.right, target)
        return findInTree(self.node, target)




# Your FindElements object will be instantiated and called as such:
# obj = FindElements(root)
# param_1 = obj.find(target)
```

ä¸Šè¿°ä»£ç ä¼šè¶…æ—¶ï¼Œæˆ‘ä»¬æ¥è€ƒè™‘ä¼˜åŒ–ã€‚

## ç©ºé—´æ¢æ—¶é—´

### æ€è·¯

ä¸Šè¿°ä»£ç ä¼šè¶…æ—¶ï¼Œæˆ‘ä»¬è€ƒè™‘ä½¿ç”¨ç©ºé—´æ¢æ—¶é—´ã€‚ å»ºç«‹æ ‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰å€¼å­˜åˆ°ä¸€ä¸ªé›†åˆä¸­å»ã€‚å½“éœ€è¦ find çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç›´æ¥æŸ¥æ‰¾ set å³å¯ï¼Œæ—¶é—´å¤æ‚åº¦ O(1)ã€‚

### ä»£ç 

```python
# Definition for a binary tree node.
# class TreeNode:
#     def __init__(self, x):
#         self.val = x
#         self.left = None
#         self.right = None

class FindElements:
    def __init__(self, root: TreeNode):
        # set ä¸èƒ½æ”¾åœ¨initå¤–ä¾§ã€‚ å› ä¸ºæµ‹è¯•ç”¨ä¾‹ä¹‹é—´ä¸ä¼šé”€æ¯FindElementsçš„å˜é‡
        self.seen = set()
        def recover(node):
            if not node:
                return node;
            if node.left:
                node.left.val =  2 * node.val + 1
                self.seen.add(node.left.val)
            if node.right:
                 node.right.val = 2 * node.val + 2
                 self.seen.add(node.right.val)
            recover(node.left)
            recover(node.right)
            return node
        root.val = 0
        self.seen.add(0)
        self.node = recover(root)


    def find(self, target: int) -> bool:
        return target in self.seen




# Your FindElements object will be instantiated and called as such:
# obj = FindElements(root)
# param_1 = obj.find(target)
```

è¿™ç§è§£æ³•å¯ä»¥ ACï¼Œä½†æ˜¯åœ¨æ•°æ®é‡éå¸¸å¤§çš„æ—¶å€™ï¼Œå¯èƒ½ MLEï¼Œæˆ‘ä»¬ç»§ç»­è€ƒè™‘ä¼˜åŒ–ã€‚

## äºŒè¿›åˆ¶æ³•

### æ€è·¯

è¿™æ˜¯ä¸€ç§éå¸¸å·§å¦™çš„åšæ³•ã€‚

å¦‚æœæˆ‘ä»¬æŠŠæ ‘ä¸­çš„æ•°å…¨éƒ¨åŠ  1 ä¼šæ€ä¹ˆæ ·ï¼Ÿ

![](https://p.ipic.vip/ok30ok.jpg)

ï¼ˆå›¾å‚è€ƒ https://leetcode.com/problems/find-elements-in-a-contaminated-binary-tree/discuss/431229/Python-Special-Way-for-find()-without-HashSet-O(1)-Space-O(logn)-Timeï¼‰

ä»”ç»†è§‚å¯Ÿå‘ç°ï¼Œæ¯ä¸€è¡Œçš„å·¦å³å­æ ‘åˆ†åˆ«æœ‰ä¸åŒçš„å‰ç¼€ï¼š

![](https://p.ipic.vip/efrz8i.jpg)

Okï¼Œé‚£ä¹ˆç®—æ³•å°±æ¥äº†ï¼Œå°±æ˜¯ç›´æ¥ç”¨ **target + 1** çš„äºŒè¿›åˆ¶è¡¨ç¤ºè¿›è¡Œ**äºŒå‰æ ‘å¯»è·¯** å³å¯ã€‚

ä¸ºäº†ä¾¿äºç†è§£ï¼Œæˆ‘ä»¬æ¥ä¸¾ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œæ¯”å¦‚ target æ˜¯ 9ï¼Œæˆ‘ä»¬é¦–å…ˆå°†å…¶åŠ  1ï¼ŒäºŒè¿›åˆ¶è¡¨ç¤ºå°±æ˜¯ 1010ã€‚ä¸è€ƒè™‘ç¬¬ä¸€ä½ï¼Œå°±æ˜¯ 010ã€‚

æˆ‘ä»¬åªè¦ï¼š

- 0 å‘å·¦ ğŸ‘ˆ
- 1 å‘å³ ğŸ‘‰
- 0 å‘å·¦ ğŸ‘ˆ

å°±å¯ä»¥æ‰¾åˆ° 9 äº†ã€‚

> 0 è¡¨ç¤ºå‘å·¦ ï¼Œ 1 è¡¨ç¤ºå‘å³

### ä»£ç 

```python
# Definition for a binary tree node.
# class TreeNode:
#     def __init__(self, x):
#         self.val = x
#         self.left = None
#         self.right = None

class FindElements:
    node = None
    def __init__(self, root: TreeNode):
        def recover(node):
            if not node:
                return node;
            if node.left:
                node.left.val =  2 * node.val + 1
            if node.right:
                 node.right.val = 2 * node.val + 2
            recover(node.left)
            recover(node.right)
            return node
        root.val = 0
        self.node = recover(root)


    def find(self, target: int) -> bool:
        node = self.node
        for bit in bin(target+1)[3:]:
            node = node and (node.left, node.right)[int(bit)]
        return bool(node)




# Your FindElements object will be instantiated and called as such:
# obj = FindElements(root)
# param_1 = obj.find(target)
```

## å…³é”®ç‚¹è§£æ

- ç©ºé—´æ¢æ—¶é—´
- äºŒè¿›åˆ¶æ€ç»´
- å°† target + 1

æ›´å¤šé¢˜è§£å¯ä»¥è®¿é—®æˆ‘çš„ LeetCode é¢˜è§£ä»“åº“ï¼šhttps://github.com/azl397985856/leetcode ã€‚ ç›®å‰å·²ç» 37K star å•¦ã€‚

å…³æ³¨å…¬ä¼—å·åŠ›æ‰£åŠ åŠ ï¼ŒåŠªåŠ›ç”¨æ¸…æ™°ç›´ç™½çš„è¯­è¨€è¿˜åŸè§£é¢˜æ€è·¯ï¼Œå¹¶ä¸”æœ‰å¤§é‡å›¾è§£ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ è¯†åˆ«å¥—è·¯ï¼Œé«˜æ•ˆåˆ·é¢˜ã€‚

![](https://p.ipic.vip/h9nm77.jpg)
